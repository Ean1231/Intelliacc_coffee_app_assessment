import{b as W}from"./chunk-DGLKXHYF.js";import{b as Z}from"./chunk-GBVQOZWS.js";import{B as c,C as x,Da as I,E as L,Fa as y,Ga as F,H as k,Ha as A,Ia as j,Ja as T,K as P,Ka as Q,L as v,M as p,N as a,Na as B,O as s,P as f,Pa as D,T as U,U as b,V as h,a as M,aa as g,ba as C,da as d,ea as u,hb as G,ja as N,jb as R,m as w,ma as E,nb as q,oa as V,t as S,u as z,ya as $}from"./chunk-YY4OCJP3.js";import"./chunk-Y2PDZ72K.js";import"./chunk-RO7BUCPQ.js";import"./chunk-GOEAN3WI.js";import"./chunk-SNC2IU6J.js";import"./chunk-5SDHGKAM.js";import"./chunk-BXPB4ZAG.js";import"./chunk-CLDSZD2A.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-DVVH2KKN.js";import"./chunk-NV3QH4JK.js";import"./chunk-REYR55MP.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import"./chunk-JHI3MBHO.js";var _=class{static sanitizeForSoap(e){return e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").trim():""}static sanitizeUsername(e){return e?e.trim().replace(/[<>&'"]/g,"").replace(/\s+/g,"_").toLowerCase():""}static sanitizeDescription(e){return e?e.trim().replace(/\s+/g," ").substring(0,500):""}static sanitizeNumber(e,o=2){let t=Number(e);return isNaN(t)?null:Math.round(t*Math.pow(10,o))/Math.pow(10,o)}};function X(r,e){if(r&1&&(a(0,"p"),g(1),d(2,"async"),s()),r&2){let o,t=h(2);c(),C((o=u(2,1,t.loadingState$))==null?null:o.operation)}}function H(r,e){if(r&1&&(a(0,"div",2),f(1,"ion-spinner",13),P(2,X,3,3,"p"),d(3,"async"),s()),r&2){let o,t=h();c(2),v((o=u(3,1,t.loadingState$))!=null&&o.operation?2:-1)}}function J(r,e){if(r&1){let o=U();a(0,"div",15),f(1,"ion-icon",16),a(2,"span"),g(3),s(),a(4,"ion-icon",17),b("click",function(){let i=S(o).index,n=h(2);return z(n.dismissError(i))}),s()()}if(r&2){let o=e.$implicit;c(3),C(o.message)}}function K(r,e){if(r&1&&(a(0,"div",3),k(1,J,5,1,"div",14),d(2,"async"),s()),r&2){let o=h();c(),p("ngForOf",u(2,1,o.errors$))}}var de=(()=>{let e=class e{constructor(t,i,n,l){this.fb=t,this.auth=i,this.uiState=n,this.router=l,this.form=this.fb.group({username:["",[y.required]],password:["",[y.required]]}),this.show=!1,this.destroy$=new M,this.loadingState$=this.uiState.loading$,this.errors$=this.uiState.errors$}ngOnInit(){this.uiState.clearErrors()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}submit(){if(this.form.invalid||this.uiState.isLoading)return;let t=this.form.value,i=_.sanitizeUsername(t.username),n=_.sanitizeForSoap(t.password);this.auth.login(i,n).pipe(w(this.destroy$)).subscribe({next:l=>{l&&this.router.navigateByUrl("/flavours",{replaceUrl:!0})},error:()=>{}})}getFieldError(t){let i=this.form.get(t);if(!i||!i.errors||!i.touched)return"";let n=i.errors;if(n.required)return`${t.charAt(0).toUpperCase()+t.slice(1)} is required`;if(n.coffeeUsername)return n.coffeeUsername.message;if(n.coffeePassword){let l=n.coffeePassword;for(let m of["minLength","maxLength","uppercase","lowercase","number","xmlSafety"])if(l[m])return l[m].message}return"Invalid input"}hasFieldError(t){let i=this.form.get(t);return!!(i&&i.errors&&i.touched)}dismissError(t){this.uiState.removeError(t)}clearAllErrors(){this.uiState.clearErrors()}};e.\u0275fac=function(i){return new(i||e)(x(B),x(W),x(Z),x($))},e.\u0275cmp=L({type:e,selectors:[["app-login"]],decls:22,vars:13,consts:[[1,"login-bg",3,"fullscreen"],[1,"wrap"],[1,"loading-overlay"],[1,"error-container"],["src","/assets/images/Coffee.png","alt","Coffee",1,"logo"],[1,"title"],[1,"login-form",3,"ngSubmit","formGroup"],[1,"field"],["type","text","formControlName","username","autocomplete","username"],["formControlName","password","autocomplete","current-password",3,"type"],[1,"eye-icon",3,"click","name"],["type","submit",1,"arrow-btn",3,"disabled"],["src","assets/images/Login_button.png","alt","Go"],["name","crescent"],["class","error-message",4,"ngFor","ngForOf"],[1,"error-message"],["name","alert-circle","color","danger"],["name","close",1,"close-btn",3,"click"]],template:function(i,n){if(i&1&&(a(0,"ion-content",0)(1,"div",1),P(2,H,4,3,"div",2),d(3,"async"),P(4,K,3,3,"div",3),d(5,"async"),f(6,"img",4),a(7,"h1",5),g(8,"LOGIN"),s(),a(9,"form",6),b("ngSubmit",function(){return n.submit()}),a(10,"div",7)(11,"label"),g(12,"USERNAME"),s(),f(13,"input",8),s(),a(14,"div",7)(15,"label"),g(16,"PASSWORD"),s(),f(17,"input",9),a(18,"ion-icon",10),b("click",function(){return n.show=!n.show}),s()(),a(19,"button",11),d(20,"async"),f(21,"img",12),s()()()()),i&2){let l,m,O;p("fullscreen",!0),c(2),v((l=u(3,7,n.loadingState$))!=null&&l.isLoading?2:-1),c(2),v((m=u(5,9,n.errors$))!=null&&m.length?4:-1),c(5),p("formGroup",n.form),c(8),p("type",n.show?"text":"password"),c(),p("name",n.show?"eye-off-outline":"eye-outline"),c(),p("disabled",n.form.invalid||((O=u(20,11,n.loadingState$))==null?null:O.isLoading))}},dependencies:[V,N,D,j,I,F,A,T,Q,G,q,R,E],styles:[".error[_ngcontent-%COMP%]{color:var(--ion-color-danger)}.login-bg[_ngcontent-%COMP%]{--background: #8b4a3a}.wrap[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column;align-items:center;padding:36px 24px 24px}.logo[_ngcontent-%COMP%]{width:150px;height:auto;margin-top:8px}.title[_ngcontent-%COMP%]{color:#fff;margin:14px 0 24px;font-weight:600;letter-spacing:2px;font-size:20px}.login-form[_ngcontent-%COMP%]{width:100%;max-width:320px;display:flex;flex-direction:column;gap:18px;margin-top:4px;flex:1}.field[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:6px;position:relative}.field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:#ffffffbf;font-size:11px;letter-spacing:1px}.field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{appearance:none;background:transparent;border:0;border-bottom:1px solid rgba(255,255,255,.35);padding:8px 2px 10px;color:#fff;font-size:15px;outline:none}.field[_ngcontent-%COMP%]   input[type=password][_ngcontent-%COMP%], .field[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]:last-child{padding-right:40px}.field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{color:#ffffff8c}.field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-bottom-color:#fff}.field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill, .field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill:hover, .field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill:focus{-webkit-text-fill-color:#fff;-webkit-box-shadow:0 0 0px 1000px transparent inset;transition:background-color 9999s ease-out 0s}.dev-note[_ngcontent-%COMP%]{color:#fff;opacity:.9;text-align:center;font-size:12px;margin:14px 0 10px}.arrow-btn[_ngcontent-%COMP%]{width:116px;height:100px;margin:6px auto 8px;background:transparent;display:flex;align-items:center;justify-content:center;transition:transform .12s ease,opacity .12s ease}.arrow-btn[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:116px;height:auto;display:block}.arrow-btn[_ngcontent-%COMP%]:active{transform:scale(.97)}.arrow-btn[disabled][_ngcontent-%COMP%]{opacity:.6;cursor:default}.toggle-eye[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:22px;color:#fff}.loading-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;z-index:9999;display:grid;place-items:center;background:#00000040}.loading-overlay[_ngcontent-%COMP%]   ion-spinner[_ngcontent-%COMP%]{--color: #fff;width:56px;height:56px}.password-field[_ngcontent-%COMP%]{position:relative}.password-field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding-right:46px}.toggle-eye[_ngcontent-%COMP%]{position:absolute;right:0;bottom:6px;padding:6px 4px;border:0;background:transparent;color:#fff;line-height:0;cursor:pointer;opacity:.9}.toggle-eye[disabled][_ngcontent-%COMP%]{opacity:.6;cursor:default}.error-container[_ngcontent-%COMP%]{width:100%;max-width:320px;margin-bottom:16px}.error-message[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;background:#f443361a;border:1px solid rgba(244,67,54,.3);border-radius:8px;padding:12px;margin-bottom:8px;color:#ffd7d7;font-size:13px}.error-message[_ngcontent-%COMP%]   ion-icon[name=alert-circle][_ngcontent-%COMP%]{color:var(--ion-color-danger);font-size:16px;flex-shrink:0}.error-message[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{flex:1;line-height:1.3}.error-message[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]{color:#ffffffb3;font-size:18px;cursor:pointer;transition:color .2s ease}.error-message[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]:hover{color:#fff}.eye-icon[_ngcontent-%COMP%]{position:absolute;right:8px;bottom:12px;color:#ffffffb3;font-size:20px;cursor:pointer;transition:color .2s ease}.eye-icon[_ngcontent-%COMP%]:hover{color:#fff}.loading-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;z-index:9999;display:flex;flex-direction:column;align-items:center;justify-content:center;background:#00000080}.loading-overlay[_ngcontent-%COMP%]   ion-spinner[_ngcontent-%COMP%]{--color: #fff;width:56px;height:56px;margin-bottom:16px}.loading-overlay[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#fff;font-size:14px;text-align:center;margin:0;opacity:.9}.error[_ngcontent-%COMP%]{color:#ffd7d7;margin:6px 0 0;font-size:12px}"]});let r=e;return r})();export{de as LoginPage};
