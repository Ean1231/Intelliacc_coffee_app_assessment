import{d as Z}from"./chunk-MHR5ZQEO.js";import{$ as b,A as c,Aa as V,B as x,Ca as C,D as z,Da as $,Ea as F,Fa as A,G as h,Ga as j,Ha as T,J as p,K as a,Ka as Q,L as s,M as f,Ma as B,Q as L,R as P,S as _,_ as d,a as O,ba as g,ca as u,eb as D,ga as k,gb as G,ha as N,ja as U,kb as R,la as I,m as M,rb as q,t as w,u as S,va as E}from"./chunk-CFUTD7MG.js";import"./chunk-Y2PDZ72K.js";import"./chunk-GOEAN3WI.js";import"./chunk-SNC2IU6J.js";import"./chunk-5SDHGKAM.js";import"./chunk-BXPB4ZAG.js";import"./chunk-CLDSZD2A.js";import"./chunk-4WFVMWDK.js";import"./chunk-M2X7KQLB.js";import"./chunk-DVVH2KKN.js";import"./chunk-NV3QH4JK.js";import"./chunk-REYR55MP.js";import"./chunk-OZYWYLNK.js";import"./chunk-42C7ZIID.js";import"./chunk-JHI3MBHO.js";var v=class{static sanitizeForSoap(e){return e?e.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;").replace(/'/g,"&#39;").trim():""}static sanitizeUsername(e){return e?e.trim().replace(/[<>&'"]/g,"").replace(/\s+/g,"_").toLowerCase():""}static sanitizeDescription(e){return e?e.trim().replace(/\s+/g," ").substring(0,500):""}static sanitizeNumber(e,o=2){let t=Number(e);return isNaN(t)?null:Math.round(t*Math.pow(10,o))/Math.pow(10,o)}};function W(i,e){if(i&1&&(a(0,"p"),d(1),g(2,"async"),s()),i&2){let o,t=_(2);c(),b((o=u(2,1,t.loadingState$))==null?null:o.operation)}}function X(i,e){if(i&1&&(a(0,"div",13),f(1,"ion-spinner",14),h(2,W,3,3,"p",15),g(3,"async"),s()),i&2){let o,t=_();c(2),p("ngIf",(o=u(3,1,t.loadingState$))==null?null:o.operation)}}function H(i,e){if(i&1){let o=L();a(0,"div",18),f(1,"ion-icon",19),a(2,"span"),d(3),s(),a(4,"ion-icon",20),P("click",function(){let r=w(o).index,n=_(2);return S(n.dismissError(r))}),s()()}if(i&2){let o=e.$implicit;c(3),b(o.message)}}function J(i,e){if(i&1&&(a(0,"div",16),h(1,H,5,1,"div",17),g(2,"async"),s()),i&2){let o=_();c(),p("ngForOf",u(2,1,o.errors$))}}var fe=(()=>{let e=class e{constructor(t,r,n,l){this.fb=t,this.auth=r,this.uiState=n,this.router=l,this.form=this.fb.group({username:["",[C.required]],password:["",[C.required]]}),this.show=!1,this.destroy$=new O,this.loadingState$=this.uiState.loading$,this.errors$=this.uiState.errors$}ngOnInit(){this.uiState.clearErrors()}ngOnDestroy(){this.destroy$.next(),this.destroy$.complete()}submit(){if(this.form.invalid||this.uiState.isLoading)return;let t=this.form.value,r=v.sanitizeUsername(t.username),n=v.sanitizeForSoap(t.password);this.auth.login(r,n).pipe(M(this.destroy$)).subscribe({next:l=>{l&&this.router.navigateByUrl("/flavours",{replaceUrl:!0})},error:()=>{}})}getFieldError(t){let r=this.form.get(t);if(!r||!r.errors||!r.touched)return"";let n=r.errors;if(n.required)return`${t.charAt(0).toUpperCase()+t.slice(1)} is required`;if(n.coffeeUsername)return n.coffeeUsername.message;if(n.coffeePassword){let l=n.coffeePassword;for(let m of["minLength","maxLength","uppercase","lowercase","number","xmlSafety"])if(l[m])return l[m].message}return"Invalid input"}hasFieldError(t){let r=this.form.get(t);return!!(r&&r.errors&&r.touched)}dismissError(t){this.uiState.removeError(t)}clearAllErrors(){this.uiState.clearErrors()}};e.\u0275fac=function(r){return new(r||e)(x(Q),x(Z),x(q),x(E))},e.\u0275cmp=z({type:e,selectors:[["app-login"]],decls:22,vars:13,consts:[[1,"login-bg",3,"fullscreen"],[1,"wrap"],["class","loading-overlay",4,"ngIf"],["class","error-container",4,"ngIf"],["src","/assets/images/Coffee.png","alt","Coffee",1,"logo"],[1,"title"],[1,"login-form",3,"ngSubmit","formGroup"],[1,"field"],["type","text","formControlName","username","autocomplete","username"],["formControlName","password","autocomplete","current-password",3,"type"],[1,"eye-icon",3,"click","name"],["type","submit",1,"arrow-btn",3,"disabled"],["src","assets/images/Login_button.png","alt","Go"],[1,"loading-overlay"],["name","crescent"],[4,"ngIf"],[1,"error-container"],["class","error-message",4,"ngFor","ngForOf"],[1,"error-message"],["name","alert-circle","color","danger"],["name","close",1,"close-btn",3,"click"]],template:function(r,n){if(r&1&&(a(0,"ion-content",0)(1,"div",1),h(2,X,4,3,"div",2),g(3,"async"),h(4,J,3,3,"div",3),g(5,"async"),f(6,"img",4),a(7,"h1",5),d(8,"LOGIN"),s(),a(9,"form",6),P("ngSubmit",function(){return n.submit()}),a(10,"div",7)(11,"label"),d(12,"USERNAME"),s(),f(13,"input",8),s(),a(14,"div",7)(15,"label"),d(16,"PASSWORD"),s(),f(17,"input",9),a(18,"ion-icon",10),P("click",function(){return n.show=!n.show}),s()(),a(19,"button",11),g(20,"async"),f(21,"img",12),s()()()()),r&2){let l,m,y;p("fullscreen",!0),c(2),p("ngIf",(l=u(3,7,n.loadingState$))==null?null:l.isLoading),c(2),p("ngIf",(m=u(5,9,n.errors$))==null?null:m.length),c(5),p("formGroup",n.form),c(8),p("type",n.show?"text":"password"),c(),p("name",n.show?"eye-off-outline":"eye-outline"),c(),p("disabled",n.form.invalid||((y=u(20,11,n.loadingState$))==null?null:y.isLoading))}},dependencies:[I,k,N,B,A,V,$,F,j,T,D,R,G,U],styles:[".error[_ngcontent-%COMP%]{color:var(--ion-color-danger)}.login-bg[_ngcontent-%COMP%]{--background: #8b4a3a}.wrap[_ngcontent-%COMP%]{height:100%;display:flex;flex-direction:column;align-items:center;padding:36px 24px 24px}.logo[_ngcontent-%COMP%]{width:150px;height:auto;margin-top:8px}.title[_ngcontent-%COMP%]{color:#fff;margin:14px 0 24px;font-weight:600;letter-spacing:2px;font-size:20px}.login-form[_ngcontent-%COMP%]{width:100%;max-width:320px;display:flex;flex-direction:column;gap:18px;margin-top:4px;flex:1}.field[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:6px;position:relative}.field[_ngcontent-%COMP%]   label[_ngcontent-%COMP%]{color:#ffffffbf;font-size:11px;letter-spacing:1px}.field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{appearance:none;background:transparent;border:0;border-bottom:1px solid rgba(255,255,255,.35);padding:8px 2px 10px;color:#fff;font-size:15px;outline:none}.field[_ngcontent-%COMP%]   input[type=password][_ngcontent-%COMP%], .field[_ngcontent-%COMP%]   input[type=text][_ngcontent-%COMP%]:last-child{padding-right:40px}.field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]::placeholder{color:#ffffff8c}.field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:focus{border-bottom-color:#fff}.field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill, .field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill:hover, .field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]:-webkit-autofill:focus{-webkit-text-fill-color:#fff;-webkit-box-shadow:0 0 0px 1000px transparent inset;transition:background-color 9999s ease-out 0s}.dev-note[_ngcontent-%COMP%]{color:#fff;opacity:.9;text-align:center;font-size:12px;margin:14px 0 10px}.arrow-btn[_ngcontent-%COMP%]{width:116px;height:100px;margin:6px auto 8px;background:transparent;display:flex;align-items:center;justify-content:center;transition:transform .12s ease,opacity .12s ease}.arrow-btn[_ngcontent-%COMP%]   img[_ngcontent-%COMP%]{width:116px;height:auto;display:block}.arrow-btn[_ngcontent-%COMP%]:active{transform:scale(.97)}.arrow-btn[disabled][_ngcontent-%COMP%]{opacity:.6;cursor:default}.toggle-eye[_ngcontent-%COMP%]   ion-icon[_ngcontent-%COMP%]{font-size:22px;color:#fff}.loading-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;z-index:9999;display:grid;place-items:center;background:#00000040}.loading-overlay[_ngcontent-%COMP%]   ion-spinner[_ngcontent-%COMP%]{--color: #fff;width:56px;height:56px}.password-field[_ngcontent-%COMP%]{position:relative}.password-field[_ngcontent-%COMP%]   input[_ngcontent-%COMP%]{padding-right:46px}.toggle-eye[_ngcontent-%COMP%]{position:absolute;right:0;bottom:6px;padding:6px 4px;border:0;background:transparent;color:#fff;line-height:0;cursor:pointer;opacity:.9}.toggle-eye[disabled][_ngcontent-%COMP%]{opacity:.6;cursor:default}.error-container[_ngcontent-%COMP%]{width:100%;max-width:320px;margin-bottom:16px}.error-message[_ngcontent-%COMP%]{display:flex;align-items:center;gap:8px;background:#f443361a;border:1px solid rgba(244,67,54,.3);border-radius:8px;padding:12px;margin-bottom:8px;color:#ffd7d7;font-size:13px}.error-message[_ngcontent-%COMP%]   ion-icon[name=alert-circle][_ngcontent-%COMP%]{color:var(--ion-color-danger);font-size:16px;flex-shrink:0}.error-message[_ngcontent-%COMP%]   span[_ngcontent-%COMP%]{flex:1;line-height:1.3}.error-message[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]{color:#ffffffb3;font-size:18px;cursor:pointer;transition:color .2s ease}.error-message[_ngcontent-%COMP%]   .close-btn[_ngcontent-%COMP%]:hover{color:#fff}.eye-icon[_ngcontent-%COMP%]{position:absolute;right:8px;bottom:12px;color:#ffffffb3;font-size:20px;cursor:pointer;transition:color .2s ease}.eye-icon[_ngcontent-%COMP%]:hover{color:#fff}.loading-overlay[_ngcontent-%COMP%]{position:fixed;inset:0;z-index:9999;display:flex;flex-direction:column;align-items:center;justify-content:center;background:#00000080}.loading-overlay[_ngcontent-%COMP%]   ion-spinner[_ngcontent-%COMP%]{--color: #fff;width:56px;height:56px;margin-bottom:16px}.loading-overlay[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{color:#fff;font-size:14px;text-align:center;margin:0;opacity:.9}.error[_ngcontent-%COMP%]{color:#ffd7d7;margin:6px 0 0;font-size:12px}"]});let i=e;return i})();export{fe as LoginPage};
