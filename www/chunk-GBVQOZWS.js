import{b as p,fa as m,ga as S,p as d,w as u}from"./chunk-YY4OCJP3.js";import{a as l,b as c}from"./chunk-JHI3MBHO.js";var b=(()=>{let i=class i{constructor(){this.STORAGE_KEY="coffee_ui_errors",this.ERROR_PERSISTENCE_DURATION=300*1e3,this.loadingStateSignal=u({isLoading:!1}),this.errorsSignal=u(this.loadPersistedErrors()),this.loadingState$=new p({isLoading:!1}),this.errorsSubject$=new p(this.loadPersistedErrors()),this.hasErrors=m(()=>this.errorsSignal().length>0),this.criticalErrors=m(()=>this.errorsSignal().filter(e=>e.type==="server"&&"statusCode"in e&&e.statusCode&&e.statusCode>=500||e.type==="network")),S(()=>{this.loadingState$.next(this.loadingStateSignal()),this.errorsSubject$.next(this.errorsSignal())}),S(()=>{this.persistErrors(this.errorsSignal())})}get loading$(){return this.loadingState$.asObservable()}get errors$(){return this.errorsSubject$.asObservable()}get loadingState(){return this.loadingStateSignal.asReadonly()}get errors(){return this.errorsSignal.asReadonly()}get isLoading(){return this.loadingStateSignal().isLoading}startLoading(e,t){this.loadingStateSignal.set({isLoading:!0,operation:e,progress:t})}updateProgress(e){let t=this.loadingStateSignal();t.isLoading&&this.loadingStateSignal.set(c(l({},t),{progress:e}))}stopLoading(){this.loadingStateSignal.set({isLoading:!1})}addError(e){let t=this.errorsSignal();this.errorsSignal.set([...t,e])}clearErrors(){this.errorsSignal.set([])}removeError(e){let t=this.errorsSignal();if(e>=0&&e<t.length){let r=[...t];r.splice(e,1),this.errorsSignal.set(r)}}clearErrorsByType(e){let r=this.errorsSignal().filter(n=>n.type!==e);this.errorsSignal.set(r)}loadPersistedErrors(){try{let e=localStorage.getItem(this.STORAGE_KEY);if(!e)return[];let t=JSON.parse(e);return Date.now()-t.timestamp>this.ERROR_PERSISTENCE_DURATION?(localStorage.removeItem(this.STORAGE_KEY),[]):t.errors.map(n=>c(l({},n),{timestamp:new Date(n.timestamp)}))}catch(e){return console.warn("Failed to load persisted errors:",e),localStorage.removeItem(this.STORAGE_KEY),[]}}persistErrors(e){try{if(e.length===0){localStorage.removeItem(this.STORAGE_KEY);return}let t={errors:e,timestamp:Date.now()};localStorage.setItem(this.STORAGE_KEY,JSON.stringify(t))}catch(t){console.warn("Failed to persist errors:",t)}}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=d({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})();var a={production:!0,soapEndpoint:"https://skynot.intelliacc.com/ws_IntelliCoffee/Service.asmx",soap:{timeout:15e3,retryAttempts:2,retryDelay:2e3,namespace:"http://tempuri.org/",headers:{"Content-Type":"text/xml; charset=utf-8",SOAPAction:"http://tempuri.org/Login"}},logging:{enableConsoleLogging:!1,logLevel:"error"}};var o=(function(s){return s[s.DEBUG=0]="DEBUG",s[s.INFO=1]="INFO",s[s.WARN=2]="WARN",s[s.ERROR=3]="ERROR",s[s.CRITICAL=4]="CRITICAL",s})(o||{}),D=(()=>{let i=class i{constructor(){this.sessionId=this.generateSessionId(),this.currentLogLevel=this.getEnvironmentLogLevel()}setContext(e){this.currentContext=e}clearContext(){this.currentContext=void 0}debug(e,t,r){this.log(o.DEBUG,e,t,r)}info(e,t,r){this.log(o.INFO,e,t,r)}warn(e,t,r){this.log(o.WARN,e,t,r)}error(e,t,r){this.log(o.ERROR,e,t,r)}critical(e,t,r){this.log(o.CRITICAL,e,t,r)}logHttpRequest(e,t,r,n){this.log(o.DEBUG,`\u{1F310} HTTP ${e} ${t}`,{method:e,url:t,requestData:n,type:"http_request"},r)}logHttpResponse(e,t,r,n,h,g){let f=r>=400?o.ERROR:o.DEBUG,E=r>=400?"\u274C":"\u2705";this.log(f,`${E} HTTP ${e} ${t} - ${r} (${n}ms)`,{method:e,url:t,status:r,duration:n,responseData:g,type:"http_response"},h)}logAuthEvent(e,t,r){this.log(o.INFO,`Auth: ${e}`,c(l({},t),{type:"auth_event"}),r)}logUserAction(e,t,r){this.log(o.INFO,`\u{1F464} User: ${e}`,c(l({},t),{userId:r,type:"user_action"}))}logPerformance(e,t,r){let n=t>5e3?o.WARN:o.DEBUG;this.log(n,`\u23F1\uFE0F Performance: ${e} took ${t}ms`,c(l({operation:e,duration:t},r),{type:"performance"}))}log(e,t,r,n){if(e<this.currentLogLevel)return;let h={level:e,message:t,timestamp:new Date,context:this.currentContext,data:r,requestId:n,sessionId:this.sessionId};this.outputLog(h),a.production&&e>=o.ERROR&&this.sendToRemoteLogger(h)}outputLog(e){let t=e.timestamp.toISOString(),r=o[e.level],n=e.context?`[${e.context}]`:"",h=e.requestId?`[${e.requestId}]`:"",g=`${t} ${r} ${n}${h}`.trim();switch(e.level){case o.DEBUG:a.logging?.enableConsoleLogging&&a.logging?.logLevel==="debug"&&console.debug(`\u{1F50D} ${g}`,e.message,e.data||"");break;case o.INFO:a.logging?.enableConsoleLogging&&console.info(`\u2139\uFE0F ${g}`,e.message,e.data||"");break;case o.WARN:console.warn(`\u26A0\uFE0F ${g}`,e.message,e.data||"");break;case o.ERROR:console.error(`\u{1F6A8} ${g}`,e.message,e.data||"");break;case o.CRITICAL:console.error(`\u{1F4A5} ${g}`,e.message,e.data||"");break}}getEnvironmentLogLevel(){if(!a.logging?.enableConsoleLogging)return o.ERROR;switch(a.logging?.logLevel){case"debug":return o.DEBUG;case"info":return o.INFO;case"warn":return o.WARN;case"error":return o.ERROR;default:return a.production?o.WARN:o.DEBUG}}generateSessionId(){return`session-${Date.now()}-${Math.random().toString(36).substr(2,9)}`}sendToRemoteLogger(e){try{let t=JSON.parse(localStorage.getItem("coffee_app_logs")||"[]");t.push(e),t.length>100&&t.splice(0,t.length-100),localStorage.setItem("coffee_app_logs",JSON.stringify(t))}catch(t){console.error("Failed to store log entry:",t)}}getStoredLogs(){try{return JSON.parse(localStorage.getItem("coffee_app_logs")||"[]")}catch(e){return console.error("Failed to retrieve stored logs:",e),[]}}clearStoredLogs(){localStorage.removeItem("coffee_app_logs")}};i.\u0275fac=function(t){return new(t||i)},i.\u0275prov=d({token:i,factory:i.\u0275fac,providedIn:"root"});let s=i;return s})();export{a,b,D as c};
